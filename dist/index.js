"use strict";var On=Object.create;var he=Object.defineProperty;var Tn=Object.getOwnPropertyDescriptor;var Cn=Object.getOwnPropertyNames;var Dn=Object.getPrototypeOf,Nn=Object.prototype.hasOwnProperty;var S=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),In=(e,t)=>{for(var r in t)he(e,r,{get:t[r],enumerable:!0})},nt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Cn(t))!Nn.call(e,i)&&i!==r&&he(e,i,{get:()=>t[i],enumerable:!(n=Tn(t,i))||n.enumerable});return e};var ie=(e,t,r)=>(r=e!=null?On(Dn(e)):{},nt(t||!e||!e.__esModule?he(r,"default",{value:e,enumerable:!0}):r,e)),Rn=e=>nt(he({},"__esModule",{value:!0}),e);var j=S(Le=>{"use strict";Le.fromCallback=function(e){return Object.defineProperty(function(...t){if(typeof t[t.length-1]=="function")e.apply(this,t);else return new Promise((r,n)=>{t.push((i,o)=>i!=null?n(i):r(o)),e.apply(this,t)})},"name",{value:e.name})};Le.fromPromise=function(e){return Object.defineProperty(function(...t){let r=t[t.length-1];if(typeof r!="function")return e.apply(this,t);t.pop(),e.apply(this,t).then(n=>r(null,n),r)},"name",{value:e.name})}});var ot=S((ou,it)=>{var U=require("constants"),An=process.cwd,Se=null,Ln=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Se||(Se=An.call(process)),Se};try{process.cwd()}catch{}typeof process.chdir=="function"&&(_e=process.chdir,process.chdir=function(e){Se=null,_e.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,_e));var _e;it.exports=_n;function _n(e){U.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||r(e),e.chown=o(e.chown),e.fchown=o(e.fchown),e.lchown=o(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=u(e.chownSync),e.fchownSync=u(e.fchownSync),e.lchownSync=u(e.lchownSync),e.chmodSync=i(e.chmodSync),e.fchmodSync=i(e.fchmodSync),e.lchmodSync=i(e.lchmodSync),e.stat=c(e.stat),e.fstat=c(e.fstat),e.lstat=c(e.lstat),e.statSync=a(e.statSync),e.fstatSync=a(e.fstatSync),e.lstatSync=a(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(s,f,y){y&&process.nextTick(y)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(s,f,y,l){l&&process.nextTick(l)},e.lchownSync=function(){}),Ln==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(s){function f(y,l,d){var q=Date.now(),E=0;s(y,l,function x($){if($&&($.code==="EACCES"||$.code==="EPERM"||$.code==="EBUSY")&&Date.now()-q<6e4){setTimeout(function(){e.stat(l,function(L,ne){L&&L.code==="ENOENT"?s(y,l,x):d($)})},E),E<100&&(E+=10);return}d&&d($)})}return Object.setPrototypeOf&&Object.setPrototypeOf(f,s),f}(e.rename)),e.read=typeof e.read!="function"?e.read:function(s){function f(y,l,d,q,E,x){var $;if(x&&typeof x=="function"){var L=0;$=function(ne,tt,rt){if(ne&&ne.code==="EAGAIN"&&L<10)return L++,s.call(e,y,l,d,q,E,$);x.apply(this,arguments)}}return s.call(e,y,l,d,q,E,$)}return Object.setPrototypeOf&&Object.setPrototypeOf(f,s),f}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(s){return function(f,y,l,d,q){for(var E=0;;)try{return s.call(e,f,y,l,d,q)}catch(x){if(x.code==="EAGAIN"&&E<10){E++;continue}throw x}}}(e.readSync);function t(s){s.lchmod=function(f,y,l){s.open(f,U.O_WRONLY|U.O_SYMLINK,y,function(d,q){if(d){l&&l(d);return}s.fchmod(q,y,function(E){s.close(q,function(x){l&&l(E||x)})})})},s.lchmodSync=function(f,y){var l=s.openSync(f,U.O_WRONLY|U.O_SYMLINK,y),d=!0,q;try{q=s.fchmodSync(l,y),d=!1}finally{if(d)try{s.closeSync(l)}catch{}else s.closeSync(l)}return q}}function r(s){U.hasOwnProperty("O_SYMLINK")&&s.futimes?(s.lutimes=function(f,y,l,d){s.open(f,U.O_SYMLINK,function(q,E){if(q){d&&d(q);return}s.futimes(E,y,l,function(x){s.close(E,function($){d&&d(x||$)})})})},s.lutimesSync=function(f,y,l){var d=s.openSync(f,U.O_SYMLINK),q,E=!0;try{q=s.futimesSync(d,y,l),E=!1}finally{if(E)try{s.closeSync(d)}catch{}else s.closeSync(d)}return q}):s.futimes&&(s.lutimes=function(f,y,l,d){d&&process.nextTick(d)},s.lutimesSync=function(){})}function n(s){return s&&function(f,y,l){return s.call(e,f,y,function(d){h(d)&&(d=null),l&&l.apply(this,arguments)})}}function i(s){return s&&function(f,y){try{return s.call(e,f,y)}catch(l){if(!h(l))throw l}}}function o(s){return s&&function(f,y,l,d){return s.call(e,f,y,l,function(q){h(q)&&(q=null),d&&d.apply(this,arguments)})}}function u(s){return s&&function(f,y,l){try{return s.call(e,f,y,l)}catch(d){if(!h(d))throw d}}}function c(s){return s&&function(f,y,l){typeof y=="function"&&(l=y,y=null);function d(q,E){E&&(E.uid<0&&(E.uid+=4294967296),E.gid<0&&(E.gid+=4294967296)),l&&l.apply(this,arguments)}return y?s.call(e,f,y,d):s.call(e,f,d)}}function a(s){return s&&function(f,y){var l=y?s.call(e,f,y):s.call(e,f);return l&&(l.uid<0&&(l.uid+=4294967296),l.gid<0&&(l.gid+=4294967296)),l}}function h(s){if(!s||s.code==="ENOSYS")return!0;var f=!process.getuid||process.getuid()!==0;return!!(f&&(s.code==="EINVAL"||s.code==="EPERM"))}}});var st=S((uu,ct)=>{var ut=require("stream").Stream;ct.exports=Mn;function Mn(e){return{ReadStream:t,WriteStream:r};function t(n,i){if(!(this instanceof t))return new t(n,i);ut.call(this);var o=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var u=Object.keys(i),c=0,a=u.length;c<a;c++){var h=u[c];this[h]=i[h]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}e.open(this.path,this.flags,this.mode,function(s,f){if(s){o.emit("error",s),o.readable=!1;return}o.fd=f,o.emit("open",f),o._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);ut.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var o=Object.keys(i),u=0,c=o.length;u<c;u++){var a=o[u];this[a]=i[a]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var ft=S((cu,at)=>{"use strict";at.exports=jn;var $n=Object.getPrototypeOf||function(e){return e.__proto__};function jn(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:$n(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}});var _=S((su,je)=>{var P=require("fs"),Wn=ot(),bn=st(),Bn=ft(),pe=require("util"),R,Ee;typeof Symbol=="function"&&typeof Symbol.for=="function"?(R=Symbol.for("graceful-fs.queue"),Ee=Symbol.for("graceful-fs.previous")):(R="___graceful-fs.queue",Ee="___graceful-fs.previous");function Jn(){}function mt(e,t){Object.defineProperty(e,R,{get:function(){return t}})}var H=Jn;pe.debuglog?H=pe.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(H=function(){var e=pe.format.apply(pe,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});P[R]||(lt=global[R]||[],mt(P,lt),P.close=function(e){function t(r,n){return e.call(P,r,function(i){i||yt(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(t,Ee,{value:e}),t}(P.close),P.closeSync=function(e){function t(r){e.apply(P,arguments),yt()}return Object.defineProperty(t,Ee,{value:e}),t}(P.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){H(P[R]),require("assert").equal(P[R].length,0)}));var lt;global[R]||mt(global,P[R]);je.exports=Me(Bn(P));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!P.__patched&&(je.exports=Me(P),P.__patched=!0);function Me(e){Wn(e),e.gracefulify=Me,e.createReadStream=tt,e.createWriteStream=rt;var t=e.readFile;e.readFile=r;function r(m,w,p){return typeof w=="function"&&(p=w,w=null),D(m,w,p);function D(N,T,F,O){return t(N,T,function(k){k&&(k.code==="EMFILE"||k.code==="ENFILE")?Z([D,[N,T,F],k,O||Date.now(),Date.now()]):typeof F=="function"&&F.apply(this,arguments)})}}var n=e.writeFile;e.writeFile=i;function i(m,w,p,D){return typeof p=="function"&&(D=p,p=null),N(m,w,p,D);function N(T,F,O,k,I){return n(T,F,O,function(g){g&&(g.code==="EMFILE"||g.code==="ENFILE")?Z([N,[T,F,O,k],g,I||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}var o=e.appendFile;o&&(e.appendFile=u);function u(m,w,p,D){return typeof p=="function"&&(D=p,p=null),N(m,w,p,D);function N(T,F,O,k,I){return o(T,F,O,function(g){g&&(g.code==="EMFILE"||g.code==="ENFILE")?Z([N,[T,F,O,k],g,I||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}var c=e.copyFile;c&&(e.copyFile=a);function a(m,w,p,D){return typeof p=="function"&&(D=p,p=0),N(m,w,p,D);function N(T,F,O,k,I){return c(T,F,O,function(g){g&&(g.code==="EMFILE"||g.code==="ENFILE")?Z([N,[T,F,O,k],g,I||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}var h=e.readdir;e.readdir=f;var s=/^v[0-5]\./;function f(m,w,p){typeof w=="function"&&(p=w,w=null);var D=s.test(process.version)?function(F,O,k,I){return h(F,N(F,O,k,I))}:function(F,O,k,I){return h(F,O,N(F,O,k,I))};return D(m,w,p);function N(T,F,O,k){return function(I,g){I&&(I.code==="EMFILE"||I.code==="ENFILE")?Z([D,[T,F,O],I,k||Date.now(),Date.now()]):(g&&g.sort&&g.sort(),typeof O=="function"&&O.call(this,I,g))}}}if(process.version.substr(0,4)==="v0.8"){var y=bn(e);x=y.ReadStream,L=y.WriteStream}var l=e.ReadStream;l&&(x.prototype=Object.create(l.prototype),x.prototype.open=$);var d=e.WriteStream;d&&(L.prototype=Object.create(d.prototype),L.prototype.open=ne),Object.defineProperty(e,"ReadStream",{get:function(){return x},set:function(m){x=m},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return L},set:function(m){L=m},enumerable:!0,configurable:!0});var q=x;Object.defineProperty(e,"FileReadStream",{get:function(){return q},set:function(m){q=m},enumerable:!0,configurable:!0});var E=L;Object.defineProperty(e,"FileWriteStream",{get:function(){return E},set:function(m){E=m},enumerable:!0,configurable:!0});function x(m,w){return this instanceof x?(l.apply(this,arguments),this):x.apply(Object.create(x.prototype),arguments)}function $(){var m=this;Ae(m.path,m.flags,m.mode,function(w,p){w?(m.autoClose&&m.destroy(),m.emit("error",w)):(m.fd=p,m.emit("open",p),m.read())})}function L(m,w){return this instanceof L?(d.apply(this,arguments),this):L.apply(Object.create(L.prototype),arguments)}function ne(){var m=this;Ae(m.path,m.flags,m.mode,function(w,p){w?(m.destroy(),m.emit("error",w)):(m.fd=p,m.emit("open",p))})}function tt(m,w){return new e.ReadStream(m,w)}function rt(m,w){return new e.WriteStream(m,w)}var Pn=e.open;e.open=Ae;function Ae(m,w,p,D){return typeof p=="function"&&(D=p,p=null),N(m,w,p,D);function N(T,F,O,k,I){return Pn(T,F,O,function(g,ru){g&&(g.code==="EMFILE"||g.code==="ENFILE")?Z([N,[T,F,O,k],g,I||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}return e}function Z(e){H("ENQUEUE",e[0].name,e[1]),P[R].push(e),$e()}var we;function yt(){for(var e=Date.now(),t=0;t<P[R].length;++t)P[R][t].length>2&&(P[R][t][3]=e,P[R][t][4]=e);$e()}function $e(){if(clearTimeout(we),we=void 0,P[R].length!==0){var e=P[R].shift(),t=e[0],r=e[1],n=e[2],i=e[3],o=e[4];if(i===void 0)H("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-i>=6e4){H("TIMEOUT",t.name,r);var u=r.pop();typeof u=="function"&&u.call(null,n)}else{var c=Date.now()-o,a=Math.max(o-i,1),h=Math.min(a*1.2,100);c>=h?(H("RETRY",t.name,r),t.apply(null,r.concat([i]))):P[R].push(e)}we===void 0&&(we=setTimeout($e,0))}}});var Q=S(G=>{"use strict";var dt=j().fromCallback,W=_(),Un=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof W[e]=="function");Object.assign(G,W);Un.forEach(e=>{G[e]=dt(W[e])});G.exists=function(e,t){return typeof t=="function"?W.exists(e,t):new Promise(r=>W.exists(e,r))};G.read=function(e,t,r,n,i,o){return typeof o=="function"?W.read(e,t,r,n,i,o):new Promise((u,c)=>{W.read(e,t,r,n,i,(a,h,s)=>{if(a)return c(a);u({bytesRead:h,buffer:s})})})};G.write=function(e,t,...r){return typeof r[r.length-1]=="function"?W.write(e,t,...r):new Promise((n,i)=>{W.write(e,t,...r,(o,u,c)=>{if(o)return i(o);n({bytesWritten:u,buffer:c})})})};typeof W.writev=="function"&&(G.writev=function(e,t,...r){return typeof r[r.length-1]=="function"?W.writev(e,t,...r):new Promise((n,i)=>{W.writev(e,t,...r,(o,u,c)=>{if(o)return i(o);n({bytesWritten:u,buffers:c})})})});typeof W.realpath.native=="function"?G.realpath.native=dt(W.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var St=S((fu,ht)=>{"use strict";var Gn=require("path");ht.exports.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(Gn.parse(t).root,""))){let n=new Error(`Path contains invalid characters: ${t}`);throw n.code="EINVAL",n}}});var vt=S((lu,We)=>{"use strict";var pt=Q(),{checkPath:wt}=St(),Et=e=>{let t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};We.exports.makeDir=async(e,t)=>(wt(e),pt.mkdir(e,{mode:Et(t),recursive:!0}));We.exports.makeDirSync=(e,t)=>(wt(e),pt.mkdirSync(e,{mode:Et(t),recursive:!0}))});var B=S((yu,kt)=>{"use strict";var Yn=j().fromPromise,{makeDir:Kn,makeDirSync:be}=vt(),Be=Yn(Kn);kt.exports={mkdirs:Be,mkdirsSync:be,mkdirp:Be,mkdirpSync:be,ensureDir:Be,ensureDirSync:be}});var Y=S((mu,gt)=>{"use strict";var Vn=j().fromPromise,qt=Q();function Xn(e){return qt.access(e).then(()=>!0).catch(()=>!1)}gt.exports={pathExists:Vn(Xn),pathExistsSync:qt.existsSync}});var Je=S((du,xt)=>{"use strict";var ee=_();function Hn(e,t,r,n){ee.open(e,"r+",(i,o)=>{if(i)return n(i);ee.futimes(o,t,r,u=>{ee.close(o,c=>{n&&n(u||c)})})})}function Qn(e,t,r){let n=ee.openSync(e,"r+");return ee.futimesSync(n,t,r),ee.closeSync(n)}xt.exports={utimesMillis:Hn,utimesMillisSync:Qn}});var z=S((hu,Ot)=>{"use strict";var te=Q(),C=require("path"),zn=require("util");function Zn(e,t,r){let n=r.dereference?i=>te.stat(i,{bigint:!0}):i=>te.lstat(i,{bigint:!0});return Promise.all([n(e),n(t).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,o])=>({srcStat:i,destStat:o}))}function ei(e,t,r){let n,i=r.dereference?u=>te.statSync(u,{bigint:!0}):u=>te.lstatSync(u,{bigint:!0}),o=i(e);try{n=i(t)}catch(u){if(u.code==="ENOENT")return{srcStat:o,destStat:null};throw u}return{srcStat:o,destStat:n}}function ti(e,t,r,n,i){zn.callbackify(Zn)(e,t,n,(o,u)=>{if(o)return i(o);let{srcStat:c,destStat:a}=u;if(a){if(oe(c,a)){let h=C.basename(e),s=C.basename(t);return r==="move"&&h!==s&&h.toLowerCase()===s.toLowerCase()?i(null,{srcStat:c,destStat:a,isChangingCase:!0}):i(new Error("Source and destination must not be the same."))}if(c.isDirectory()&&!a.isDirectory())return i(new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`));if(!c.isDirectory()&&a.isDirectory())return i(new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`))}return c.isDirectory()&&Ue(e,t)?i(new Error(ve(e,t,r))):i(null,{srcStat:c,destStat:a})})}function ri(e,t,r,n){let{srcStat:i,destStat:o}=ei(e,t,n);if(o){if(oe(i,o)){let u=C.basename(e),c=C.basename(t);if(r==="move"&&u!==c&&u.toLowerCase()===c.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(i.isDirectory()&&Ue(e,t))throw new Error(ve(e,t,r));return{srcStat:i,destStat:o}}function Ft(e,t,r,n,i){let o=C.resolve(C.dirname(e)),u=C.resolve(C.dirname(r));if(u===o||u===C.parse(u).root)return i();te.stat(u,{bigint:!0},(c,a)=>c?c.code==="ENOENT"?i():i(c):oe(t,a)?i(new Error(ve(e,r,n))):Ft(e,t,u,n,i))}function Pt(e,t,r,n){let i=C.resolve(C.dirname(e)),o=C.resolve(C.dirname(r));if(o===i||o===C.parse(o).root)return;let u;try{u=te.statSync(o,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(oe(t,u))throw new Error(ve(e,r,n));return Pt(e,t,o,n)}function oe(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function Ue(e,t){let r=C.resolve(e).split(C.sep).filter(i=>i),n=C.resolve(t).split(C.sep).filter(i=>i);return r.reduce((i,o,u)=>i&&n[u]===o,!0)}function ve(e,t,r){return`Cannot ${r} '${e}' to a subdirectory of itself, '${t}'.`}Ot.exports={checkPaths:ti,checkPathsSync:ri,checkParentPaths:Ft,checkParentPathsSync:Pt,isSrcSubdir:Ue,areIdentical:oe}});var Lt=S((Su,At)=>{"use strict";var b=_(),ue=require("path"),ni=B().mkdirs,ii=Y().pathExists,oi=Je().utimesMillis,ce=z();function ui(e,t,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001"),ce.checkPaths(e,t,"copy",r,(i,o)=>{if(i)return n(i);let{srcStat:u,destStat:c}=o;ce.checkParentPaths(e,u,t,"copy",a=>a?n(a):r.filter?Dt(Tt,c,e,t,r,n):Tt(c,e,t,r,n))})}function Tt(e,t,r,n,i){let o=ue.dirname(r);ii(o,(u,c)=>{if(u)return i(u);if(c)return ke(e,t,r,n,i);ni(o,a=>a?i(a):ke(e,t,r,n,i))})}function Dt(e,t,r,n,i,o){Promise.resolve(i.filter(r,n)).then(u=>u?e(t,r,n,i,o):o(),u=>o(u))}function ci(e,t,r,n,i){return n.filter?Dt(ke,e,t,r,n,i):ke(e,t,r,n,i)}function ke(e,t,r,n,i){(n.dereference?b.stat:b.lstat)(t,(u,c)=>u?i(u):c.isDirectory()?di(c,e,t,r,n,i):c.isFile()||c.isCharacterDevice()||c.isBlockDevice()?si(c,e,t,r,n,i):c.isSymbolicLink()?pi(e,t,r,n,i):c.isSocket()?i(new Error(`Cannot copy a socket file: ${t}`)):c.isFIFO()?i(new Error(`Cannot copy a FIFO pipe: ${t}`)):i(new Error(`Unknown file: ${t}`)))}function si(e,t,r,n,i,o){return t?ai(e,r,n,i,o):Nt(e,r,n,i,o)}function ai(e,t,r,n,i){if(n.overwrite)b.unlink(r,o=>o?i(o):Nt(e,t,r,n,i));else return n.errorOnExist?i(new Error(`'${r}' already exists`)):i()}function Nt(e,t,r,n,i){b.copyFile(t,r,o=>o?i(o):n.preserveTimestamps?fi(e.mode,t,r,i):qe(r,e.mode,i))}function fi(e,t,r,n){return li(e)?yi(r,e,i=>i?n(i):Ct(e,t,r,n)):Ct(e,t,r,n)}function li(e){return(e&128)===0}function yi(e,t,r){return qe(e,t|128,r)}function Ct(e,t,r,n){mi(t,r,i=>i?n(i):qe(r,e,n))}function qe(e,t,r){return b.chmod(e,t,r)}function mi(e,t,r){b.stat(e,(n,i)=>n?r(n):oi(t,i.atime,i.mtime,r))}function di(e,t,r,n,i,o){return t?It(r,n,i,o):hi(e.mode,r,n,i,o)}function hi(e,t,r,n,i){b.mkdir(r,o=>{if(o)return i(o);It(t,r,n,u=>u?i(u):qe(r,e,i))})}function It(e,t,r,n){b.readdir(e,(i,o)=>i?n(i):Rt(o,e,t,r,n))}function Rt(e,t,r,n,i){let o=e.pop();return o?Si(e,o,t,r,n,i):i()}function Si(e,t,r,n,i,o){let u=ue.join(r,t),c=ue.join(n,t);ce.checkPaths(u,c,"copy",i,(a,h)=>{if(a)return o(a);let{destStat:s}=h;ci(s,u,c,i,f=>f?o(f):Rt(e,r,n,i,o))})}function pi(e,t,r,n,i){b.readlink(t,(o,u)=>{if(o)return i(o);if(n.dereference&&(u=ue.resolve(process.cwd(),u)),e)b.readlink(r,(c,a)=>c?c.code==="EINVAL"||c.code==="UNKNOWN"?b.symlink(u,r,i):i(c):(n.dereference&&(a=ue.resolve(process.cwd(),a)),ce.isSrcSubdir(u,a)?i(new Error(`Cannot copy '${u}' to a subdirectory of itself, '${a}'.`)):e.isDirectory()&&ce.isSrcSubdir(a,u)?i(new Error(`Cannot overwrite '${a}' with '${u}'.`)):wi(u,r,i)));else return b.symlink(u,r,i)})}function wi(e,t,r){b.unlink(t,n=>n?r(n):b.symlink(e,t,r))}At.exports=ui});var Wt=S((pu,jt)=>{"use strict";var A=_(),se=require("path"),Ei=B().mkdirsSync,vi=Je().utimesMillisSync,ae=z();function ki(e,t,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:i}=ae.checkPathsSync(e,t,"copy",r);return ae.checkParentPathsSync(e,n,t,"copy"),qi(i,e,t,r)}function qi(e,t,r,n){if(n.filter&&!n.filter(t,r))return;let i=se.dirname(r);return A.existsSync(i)||Ei(i),_t(e,t,r,n)}function gi(e,t,r,n){if(!(n.filter&&!n.filter(t,r)))return _t(e,t,r,n)}function _t(e,t,r,n){let o=(n.dereference?A.statSync:A.lstatSync)(t);if(o.isDirectory())return Di(o,e,t,r,n);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return xi(o,e,t,r,n);if(o.isSymbolicLink())return Ri(e,t,r,n);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function xi(e,t,r,n,i){return t?Fi(e,r,n,i):Mt(e,r,n,i)}function Fi(e,t,r,n){if(n.overwrite)return A.unlinkSync(r),Mt(e,t,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function Mt(e,t,r,n){return A.copyFileSync(t,r),n.preserveTimestamps&&Pi(e.mode,t,r),Ge(r,e.mode)}function Pi(e,t,r){return Oi(e)&&Ti(r,e),Ci(t,r)}function Oi(e){return(e&128)===0}function Ti(e,t){return Ge(e,t|128)}function Ge(e,t){return A.chmodSync(e,t)}function Ci(e,t){let r=A.statSync(e);return vi(t,r.atime,r.mtime)}function Di(e,t,r,n,i){return t?$t(r,n,i):Ni(e.mode,r,n,i)}function Ni(e,t,r,n){return A.mkdirSync(r),$t(t,r,n),Ge(r,e)}function $t(e,t,r){A.readdirSync(e).forEach(n=>Ii(n,e,t,r))}function Ii(e,t,r,n){let i=se.join(t,e),o=se.join(r,e),{destStat:u}=ae.checkPathsSync(i,o,"copy",n);return gi(u,i,o,n)}function Ri(e,t,r,n){let i=A.readlinkSync(t);if(n.dereference&&(i=se.resolve(process.cwd(),i)),e){let o;try{o=A.readlinkSync(r)}catch(u){if(u.code==="EINVAL"||u.code==="UNKNOWN")return A.symlinkSync(i,r);throw u}if(n.dereference&&(o=se.resolve(process.cwd(),o)),ae.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(A.statSync(r).isDirectory()&&ae.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return Ai(i,r)}else return A.symlinkSync(i,r)}function Ai(e,t){return A.unlinkSync(t),A.symlinkSync(e,t)}jt.exports=ki});var ge=S((wu,bt)=>{"use strict";var Li=j().fromCallback;bt.exports={copy:Li(Lt()),copySync:Wt()}});var Ht=S((Eu,Xt)=>{"use strict";var Bt=_(),Yt=require("path"),v=require("assert"),fe=process.platform==="win32";function Kt(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{e[r]=e[r]||Bt[r],r=r+"Sync",e[r]=e[r]||Bt[r]}),e.maxBusyTries=e.maxBusyTries||3}function Ye(e,t,r){let n=0;typeof t=="function"&&(r=t,t={}),v(e,"rimraf: missing path"),v.strictEqual(typeof e,"string","rimraf: path should be a string"),v.strictEqual(typeof r,"function","rimraf: callback function required"),v(t,"rimraf: invalid options argument provided"),v.strictEqual(typeof t,"object","rimraf: options should be object"),Kt(t),Jt(e,t,function i(o){if(o){if((o.code==="EBUSY"||o.code==="ENOTEMPTY"||o.code==="EPERM")&&n<t.maxBusyTries){n++;let u=n*100;return setTimeout(()=>Jt(e,t,i),u)}o.code==="ENOENT"&&(o=null)}r(o)})}function Jt(e,t,r){v(e),v(t),v(typeof r=="function"),t.lstat(e,(n,i)=>{if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&fe)return Ut(e,t,n,r);if(i&&i.isDirectory())return xe(e,t,n,r);t.unlink(e,o=>{if(o){if(o.code==="ENOENT")return r(null);if(o.code==="EPERM")return fe?Ut(e,t,o,r):xe(e,t,o,r);if(o.code==="EISDIR")return xe(e,t,o,r)}return r(o)})})}function Ut(e,t,r,n){v(e),v(t),v(typeof n=="function"),t.chmod(e,438,i=>{i?n(i.code==="ENOENT"?null:r):t.stat(e,(o,u)=>{o?n(o.code==="ENOENT"?null:r):u.isDirectory()?xe(e,t,r,n):t.unlink(e,n)})})}function Gt(e,t,r){let n;v(e),v(t);try{t.chmodSync(e,438)}catch(i){if(i.code==="ENOENT")return;throw r}try{n=t.statSync(e)}catch(i){if(i.code==="ENOENT")return;throw r}n.isDirectory()?Fe(e,t,r):t.unlinkSync(e)}function xe(e,t,r,n){v(e),v(t),v(typeof n=="function"),t.rmdir(e,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?_i(e,t,n):i&&i.code==="ENOTDIR"?n(r):n(i)})}function _i(e,t,r){v(e),v(t),v(typeof r=="function"),t.readdir(e,(n,i)=>{if(n)return r(n);let o=i.length,u;if(o===0)return t.rmdir(e,r);i.forEach(c=>{Ye(Yt.join(e,c),t,a=>{if(!u){if(a)return r(u=a);--o===0&&t.rmdir(e,r)}})})})}function Vt(e,t){let r;t=t||{},Kt(t),v(e,"rimraf: missing path"),v.strictEqual(typeof e,"string","rimraf: path should be a string"),v(t,"rimraf: missing options"),v.strictEqual(typeof t,"object","rimraf: options should be object");try{r=t.lstatSync(e)}catch(n){if(n.code==="ENOENT")return;n.code==="EPERM"&&fe&&Gt(e,t,n)}try{r&&r.isDirectory()?Fe(e,t,null):t.unlinkSync(e)}catch(n){if(n.code==="ENOENT")return;if(n.code==="EPERM")return fe?Gt(e,t,n):Fe(e,t,n);if(n.code!=="EISDIR")throw n;Fe(e,t,n)}}function Fe(e,t,r){v(e),v(t);try{t.rmdirSync(e)}catch(n){if(n.code==="ENOTDIR")throw r;if(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")Mi(e,t);else if(n.code!=="ENOENT")throw n}}function Mi(e,t){if(v(e),v(t),t.readdirSync(e).forEach(r=>Vt(Yt.join(e,r),t)),fe){let r=Date.now();do try{return t.rmdirSync(e,t)}catch{}while(Date.now()-r<500)}else return t.rmdirSync(e,t)}Xt.exports=Ye;Ye.sync=Vt});var le=S((vu,zt)=>{"use strict";var Pe=_(),$i=j().fromCallback,Qt=Ht();function ji(e,t){if(Pe.rm)return Pe.rm(e,{recursive:!0,force:!0},t);Qt(e,t)}function Wi(e){if(Pe.rmSync)return Pe.rmSync(e,{recursive:!0,force:!0});Qt.sync(e)}zt.exports={remove:$i(ji),removeSync:Wi}});var ur=S((ku,or)=>{"use strict";var bi=j().fromPromise,tr=Q(),rr=require("path"),nr=B(),ir=le(),Zt=bi(async function(t){let r;try{r=await tr.readdir(t)}catch{return nr.mkdirs(t)}return Promise.all(r.map(n=>ir.remove(rr.join(t,n))))});function er(e){let t;try{t=tr.readdirSync(e)}catch{return nr.mkdirsSync(e)}t.forEach(r=>{r=rr.join(e,r),ir.removeSync(r)})}or.exports={emptyDirSync:er,emptydirSync:er,emptyDir:Zt,emptydir:Zt}});var fr=S((qu,ar)=>{"use strict";var Bi=j().fromCallback,cr=require("path"),K=_(),sr=B();function Ji(e,t){function r(){K.writeFile(e,"",n=>{if(n)return t(n);t()})}K.stat(e,(n,i)=>{if(!n&&i.isFile())return t();let o=cr.dirname(e);K.stat(o,(u,c)=>{if(u)return u.code==="ENOENT"?sr.mkdirs(o,a=>{if(a)return t(a);r()}):t(u);c.isDirectory()?r():K.readdir(o,a=>{if(a)return t(a)})})})}function Ui(e){let t;try{t=K.statSync(e)}catch{}if(t&&t.isFile())return;let r=cr.dirname(e);try{K.statSync(r).isDirectory()||K.readdirSync(r)}catch(n){if(n&&n.code==="ENOENT")sr.mkdirsSync(r);else throw n}K.writeFileSync(e,"")}ar.exports={createFile:Bi(Ji),createFileSync:Ui}});var hr=S((gu,dr)=>{"use strict";var Gi=j().fromCallback,lr=require("path"),V=_(),yr=B(),Yi=Y().pathExists,{areIdentical:mr}=z();function Ki(e,t,r){function n(i,o){V.link(i,o,u=>{if(u)return r(u);r(null)})}V.lstat(t,(i,o)=>{V.lstat(e,(u,c)=>{if(u)return u.message=u.message.replace("lstat","ensureLink"),r(u);if(o&&mr(c,o))return r(null);let a=lr.dirname(t);Yi(a,(h,s)=>{if(h)return r(h);if(s)return n(e,t);yr.mkdirs(a,f=>{if(f)return r(f);n(e,t)})})})})}function Vi(e,t){let r;try{r=V.lstatSync(t)}catch{}try{let o=V.lstatSync(e);if(r&&mr(o,r))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let n=lr.dirname(t);return V.existsSync(n)||yr.mkdirsSync(n),V.linkSync(e,t)}dr.exports={createLink:Gi(Ki),createLinkSync:Vi}});var pr=S((xu,Sr)=>{"use strict";var X=require("path"),ye=_(),Xi=Y().pathExists;function Hi(e,t,r){if(X.isAbsolute(e))return ye.lstat(e,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:e,toDst:e}));{let n=X.dirname(t),i=X.join(n,e);return Xi(i,(o,u)=>o?r(o):u?r(null,{toCwd:i,toDst:e}):ye.lstat(e,c=>c?(c.message=c.message.replace("lstat","ensureSymlink"),r(c)):r(null,{toCwd:e,toDst:X.relative(n,e)})))}}function Qi(e,t){let r;if(X.isAbsolute(e)){if(r=ye.existsSync(e),!r)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}else{let n=X.dirname(t),i=X.join(n,e);if(r=ye.existsSync(i),r)return{toCwd:i,toDst:e};if(r=ye.existsSync(e),!r)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:X.relative(n,e)}}}Sr.exports={symlinkPaths:Hi,symlinkPathsSync:Qi}});var vr=S((Fu,Er)=>{"use strict";var wr=_();function zi(e,t,r){if(r=typeof t=="function"?t:r,t=typeof t=="function"?!1:t,t)return r(null,t);wr.lstat(e,(n,i)=>{if(n)return r(null,"file");t=i&&i.isDirectory()?"dir":"file",r(null,t)})}function Zi(e,t){let r;if(t)return t;try{r=wr.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}Er.exports={symlinkType:zi,symlinkTypeSync:Zi}});var Tr=S((Pu,Or)=>{"use strict";var eo=j().fromCallback,qr=require("path"),J=Q(),gr=B(),to=gr.mkdirs,ro=gr.mkdirsSync,xr=pr(),no=xr.symlinkPaths,io=xr.symlinkPathsSync,Fr=vr(),oo=Fr.symlinkType,uo=Fr.symlinkTypeSync,co=Y().pathExists,{areIdentical:Pr}=z();function so(e,t,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,J.lstat(t,(i,o)=>{!i&&o.isSymbolicLink()?Promise.all([J.stat(e),J.stat(t)]).then(([u,c])=>{if(Pr(u,c))return n(null);kr(e,t,r,n)}):kr(e,t,r,n)})}function kr(e,t,r,n){no(e,t,(i,o)=>{if(i)return n(i);e=o.toDst,oo(o.toCwd,r,(u,c)=>{if(u)return n(u);let a=qr.dirname(t);co(a,(h,s)=>{if(h)return n(h);if(s)return J.symlink(e,t,c,n);to(a,f=>{if(f)return n(f);J.symlink(e,t,c,n)})})})})}function ao(e,t,r){let n;try{n=J.lstatSync(t)}catch{}if(n&&n.isSymbolicLink()){let c=J.statSync(e),a=J.statSync(t);if(Pr(c,a))return}let i=io(e,t);e=i.toDst,r=uo(i.toCwd,r);let o=qr.dirname(t);return J.existsSync(o)||ro(o),J.symlinkSync(e,t,r)}Or.exports={createSymlink:eo(so),createSymlinkSync:ao}});var _r=S((Ou,Lr)=>{"use strict";var{createFile:Cr,createFileSync:Dr}=fr(),{createLink:Nr,createLinkSync:Ir}=hr(),{createSymlink:Rr,createSymlinkSync:Ar}=Tr();Lr.exports={createFile:Cr,createFileSync:Dr,ensureFile:Cr,ensureFileSync:Dr,createLink:Nr,createLinkSync:Ir,ensureLink:Nr,ensureLinkSync:Ir,createSymlink:Rr,createSymlinkSync:Ar,ensureSymlink:Rr,ensureSymlinkSync:Ar}});var Oe=S((Tu,Mr)=>{function fo(e,{EOL:t=`
`,finalEOL:r=!0,replacer:n=null,spaces:i}={}){let o=r?t:"";return JSON.stringify(e,n,i).replace(/\n/g,t)+o}function lo(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}Mr.exports={stringify:fo,stripBom:lo}});var br=S((Cu,Wr)=>{var re;try{re=_()}catch{re=require("fs")}var Te=j(),{stringify:$r,stripBom:jr}=Oe();async function yo(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||re,n="throws"in t?t.throws:!0,i=await Te.fromCallback(r.readFile)(e,t);i=jr(i);let o;try{o=JSON.parse(i,t?t.reviver:null)}catch(u){if(n)throw u.message=`${e}: ${u.message}`,u;return null}return o}var mo=Te.fromPromise(yo);function ho(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||re,n="throws"in t?t.throws:!0;try{let i=r.readFileSync(e,t);return i=jr(i),JSON.parse(i,t.reviver)}catch(i){if(n)throw i.message=`${e}: ${i.message}`,i;return null}}async function So(e,t,r={}){let n=r.fs||re,i=$r(t,r);await Te.fromCallback(n.writeFile)(e,i,r)}var po=Te.fromPromise(So);function wo(e,t,r={}){let n=r.fs||re,i=$r(t,r);return n.writeFileSync(e,i,r)}var Eo={readFile:mo,readFileSync:ho,writeFile:po,writeFileSync:wo};Wr.exports=Eo});var Jr=S((Du,Br)=>{"use strict";var Ce=br();Br.exports={readJson:Ce.readFile,readJsonSync:Ce.readFileSync,writeJson:Ce.writeFile,writeJsonSync:Ce.writeFileSync}});var De=S((Nu,Yr)=>{"use strict";var vo=j().fromCallback,me=_(),Ur=require("path"),Gr=B(),ko=Y().pathExists;function qo(e,t,r,n){typeof r=="function"&&(n=r,r="utf8");let i=Ur.dirname(e);ko(i,(o,u)=>{if(o)return n(o);if(u)return me.writeFile(e,t,r,n);Gr.mkdirs(i,c=>{if(c)return n(c);me.writeFile(e,t,r,n)})})}function go(e,...t){let r=Ur.dirname(e);if(me.existsSync(r))return me.writeFileSync(e,...t);Gr.mkdirsSync(r),me.writeFileSync(e,...t)}Yr.exports={outputFile:vo(qo),outputFileSync:go}});var Vr=S((Iu,Kr)=>{"use strict";var{stringify:xo}=Oe(),{outputFile:Fo}=De();async function Po(e,t,r={}){let n=xo(t,r);await Fo(e,n,r)}Kr.exports=Po});var Hr=S((Ru,Xr)=>{"use strict";var{stringify:Oo}=Oe(),{outputFileSync:To}=De();function Co(e,t,r){let n=Oo(t,r);To(e,n,r)}Xr.exports=Co});var zr=S((Au,Qr)=>{"use strict";var Do=j().fromPromise,M=Jr();M.outputJson=Do(Vr());M.outputJsonSync=Hr();M.outputJSON=M.outputJson;M.outputJSONSync=M.outputJsonSync;M.writeJSON=M.writeJson;M.writeJSONSync=M.writeJsonSync;M.readJSON=M.readJson;M.readJSONSync=M.readJsonSync;Qr.exports=M});var nn=S((Lu,rn)=>{"use strict";var No=_(),Ve=require("path"),Io=ge().copy,tn=le().remove,Ro=B().mkdirp,Ao=Y().pathExists,Zr=z();function Lo(e,t,r,n){typeof r=="function"&&(n=r,r={}),r=r||{};let i=r.overwrite||r.clobber||!1;Zr.checkPaths(e,t,"move",r,(o,u)=>{if(o)return n(o);let{srcStat:c,isChangingCase:a=!1}=u;Zr.checkParentPaths(e,c,t,"move",h=>{if(h)return n(h);if(_o(t))return en(e,t,i,a,n);Ro(Ve.dirname(t),s=>s?n(s):en(e,t,i,a,n))})})}function _o(e){let t=Ve.dirname(e);return Ve.parse(t).root===t}function en(e,t,r,n,i){if(n)return Ke(e,t,r,i);if(r)return tn(t,o=>o?i(o):Ke(e,t,r,i));Ao(t,(o,u)=>o?i(o):u?i(new Error("dest already exists.")):Ke(e,t,r,i))}function Ke(e,t,r,n){No.rename(e,t,i=>i?i.code!=="EXDEV"?n(i):Mo(e,t,r,n):n())}function Mo(e,t,r,n){Io(e,t,{overwrite:r,errorOnExist:!0},o=>o?n(o):tn(e,n))}rn.exports=Lo});var an=S((_u,sn)=>{"use strict";var un=_(),He=require("path"),$o=ge().copySync,cn=le().removeSync,jo=B().mkdirpSync,on=z();function Wo(e,t,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:i,isChangingCase:o=!1}=on.checkPathsSync(e,t,"move",r);return on.checkParentPathsSync(e,i,t,"move"),bo(t)||jo(He.dirname(t)),Bo(e,t,n,o)}function bo(e){let t=He.dirname(e);return He.parse(t).root===t}function Bo(e,t,r,n){if(n)return Xe(e,t,r);if(r)return cn(t),Xe(e,t,r);if(un.existsSync(t))throw new Error("dest already exists.");return Xe(e,t,r)}function Xe(e,t,r){try{un.renameSync(e,t)}catch(n){if(n.code!=="EXDEV")throw n;return Jo(e,t,r)}}function Jo(e,t,r){return $o(e,t,{overwrite:r,errorOnExist:!0}),cn(e)}sn.exports=Wo});var ln=S((Mu,fn)=>{"use strict";var Uo=j().fromCallback;fn.exports={move:Uo(nn()),moveSync:an()}});var Qe=S(($u,yn)=>{"use strict";yn.exports={...Q(),...ge(),...ur(),..._r(),...zr(),...B(),...ln(),...De(),...Y(),...le()}});var tu={};In(tu,{enqueue:()=>zo,getDb:()=>Zo,startWriters:()=>Qo,workerCount:()=>eu});module.exports=Rn(tu);var Sn=ie(require("os")),pn=require("worker_threads"),wn=ie(Qe());var mn=require("child_process"),dn=ie(require("util")),hn=dn.default.promisify(mn.exec);var de=[],En=Sn.cpus(),Ie=En.length,Go=/CREATE TABLE IF NOT EXISTS ([^\s]+) \(/,Yo=/CREATE\s+TABLE\s+IF\s+NOT\s+EXISTS\s*(\w+)\s*\(([\s\S]*?)\)/i,Ko=/(\w+)\s+(\w+)/ig,Vo=`const { parentPort } = require('worker_threads')
const SqliteDatabaseConnection = require('better-sqlite3')

let db
let transactionFactory
let typeCache
let typeCacheKeys
let typeCacheInsert
const escapeRegex = /'/g

function defaultRowParser (data) {
  let result = ''

  for (const item of data) {
    let query = 'INSERT INTO ' + typeCache.tableName + ' (' + typeCacheInsert + ') VALUES ('
    let index = 0

    for(const key of typeCacheKeys) {
      switch (typeCache.fields[key]) {
        case 'TEXT':
        case 'VARCHAR':
        case 'CHAR':
        case 'NCHAR':
        case 'NVARCHAR':
          query += "'" + item[key].replace(escapeRegex, "''") + "'"
          break
        default:
          query += item[key]
      }

      if (index < typeCacheKeys.length - 1) {
        query += ','
      }

      index += 1
    }

    result += query + ');'
  }

  return result
}

parentPort.on('message', (command) => {
  try{
  const { type } = command

  if (type === 'connect') {
    // Initial connection
    const { transactions, path } = command
    typeCache = command.typeCache
    typeCacheKeys = Object.keys(command.typeCache.fields)
    typeCacheInsert = typeCacheKeys.join(', ')

    db = new SqliteDatabaseConnection(path)
    db.exec('PRAGMA journal_mode = OFF;')
    db.exec('PRAGMA synchronous = 0;')
    db.exec('PRAGMA cache_size = 1000000;')
    db.exec('PRAGMA locking_mode = EXCLUSIVE')
    db.exec('PRAGMA temp_store = MEMORY;')

    transactionFactory = transactions === undefined
      ? defaultRowParser
      : new Function('return ' + transactions)()

  } else if (type === 'collection') {
    // Dealing with transactions
    const { data } = command

    db.exec('BEGIN TRANSACTION;' + transactionFactory(data) + 'COMMIT;')
    parentPort.postMessage(true)

  } else {
    // Arbitrary sql
    const { sql } = command
    parentPort.postMessage(db.exec(sql))
  }
}catch(e){
  console.error(e)
}
})`,Ne=[],ze=0,Ze=!1,et=0;async function Xo(e,t){let r=[];return new Promise(n=>{function i(o,u){let c=new pn.Worker(Vo,{eval:!0});r.push(c);let a=null;function h(){return!a&&de.length?(et+=1,a=de.shift(),c.postMessage(a.message),!0):!1}c.on("online",()=>{Ne.push({takeWork:h,shutdown:()=>c.terminate()}),h()}).on("message",async s=>{if(s===!0){if(et-=1,de.length===0&&et===0&&await t(r)===!0)return n(!0)}else{if(a===null)return;a.resolve(s),a=null,h()}}).on("error",s=>{console.error(s)}),e(c,u)}En.forEach(i)})}var vn=async e=>new Promise((t,r)=>{de.push({resolve:t,reject:r,message:e});let n=0;for(let i of Ne){if(n===ze){i.takeWork(),ze=(ze+1)%Ie;break}n+=1}});function Ho(e){let t=Yo.exec(e);if(!t)throw new Error("Invalid CREATE TABLE statement");let r=t[1],n=t[2].trim(),i={},o;for(;(o=Ko.exec(n))!==null;){let u=o[1],c=o[2].toUpperCase();i[u]=c}return{tableName:r,fields:i}}var kn=async(e,t,r,n=void 0,i=!0)=>{(0,wn.ensureDirSync)(e);let o="CREATE TABLE IF NOT EXISTS "+r+";",u=Ho(o);return Xo((c,a)=>{c.postMessage({typeCache:u,type:"connect",path:e+"/"+t+"."+a+".sqlite",transactions:n?.toString()}),c.postMessage({sql:o})},async c=>{if(de.length>0||i===!1||Ze)return!1;Ze=!0,await Promise.all(Ne.map((s,f)=>new Promise(y=>{c[f].on("exit",y),s.shutdown()}))),Ne=[];let a=e+"/"+t+".sqlite",h=[`(rm -f "${a}" && touch "${a}")`];for(let s=0;s<Ie;s++){let f=e+"/"+t+"."+s+".sqlite",y=o.match(Go)[1];h.push(`(sqlite3 "${f}" ".dump ${y}" | sed -e 's/CREATE TABLE ${y} /CREATE TABLE IF NOT EXISTS ${y} /' | sqlite3 "${a}")`),h.push(`(rm -f "${f}" && rm -f "${f}-journal")`)}return await hn(`(${h.join(" && ")})`),Ze=!1,!0})};var qn=ie(require("better-sqlite3"));var gn=ie(Qe()),Re={},xn=e=>(Re[e]===void 0&&((0,gn.ensureFileSync)(e),Re[e]=new qn.default(e),process.on("exit",()=>Re[e].close()),process.on("SIGHUP",()=>process.exit(129)),process.on("SIGINT",()=>process.exit(130)),process.on("SIGTERM",()=>process.exit(143))),Re[e]),Fn=async e=>vn({type:"collection",data:e});var Qo=kn,zo=Fn,Zo=xn,eu=Ie;0&&(module.exports={enqueue,getDb,startWriters,workerCount});
