import{parentPort as o}from"worker_threads";import*as i from"os";import{Worker as d}from"worker_threads";import{ensureDirSync as k}from"fs-extra";import{exec as A}from"shelljs";var p=i.cpus(),f=p.length;import m from"better-sqlite3";import{ensureFileSync as g}from"fs-extra";var r={},c=e=>(r[e]===void 0&&(g(e),r[e]=new m(e,{verbose:console.log})),r[e]);var a=c;var t,u;o.on("message",e=>{let{type:s}=e;if(s==="connect"){let{transactions:n,path:l}=e;t=a(l),t.exec("PRAGMA journal_mode = OFF;"),t.exec("PRAGMA synchronous = 0;"),t.exec("PRAGMA cache_size = 1000000;"),t.exec("PRAGMA locking_mode = EXCLUSIVE"),t.exec("PRAGMA temp_store = MEMORY;"),u=new Function(`return ${n}`)()}else if(s==="collection"){let{data:n}=e;t.exec(`BEGIN TRANSACTION;${u(n)}COMMIT;`),o.postMessage(!0)}else{let{sql:n}=e;o.postMessage(t.exec(n))}});
//# sourceMappingURL=insert.js.map